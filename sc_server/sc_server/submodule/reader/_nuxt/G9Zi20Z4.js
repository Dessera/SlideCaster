import{L as X,_ as T,T as Y,U as K,aF as $,S as Z,aE as M,c0 as ee,Y as te,d as ne,c9 as ae,J as oe,i as k,z as se,O as re,a1 as le,ca as ue,cb as ce,au as ie,cc as fe,cd as pe,r as h,ai as de,F as _,a8 as me}from"./DRufy4CT.js";import{u as w,a as ye,b as Q,c as L,d as ge,e as E}from"./Cr-Uwpqp.js";const J=["wrap","nowrap","wrap-reverse"],z=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],H=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],ve=(e,t)=>{const n={};return J.forEach(a=>{n[`${e}-wrap-${a}`]=t.wrap===a}),n},Se=(e,t)=>{const n={};return H.forEach(a=>{n[`${e}-align-${a}`]=t.align===a}),n[`${e}-align-stretch`]=!t.align&&!!t.vertical,n},xe=(e,t)=>{const n={};return z.forEach(a=>{n[`${e}-justify-${a}`]=t.justify===a}),n};function Ce(e,t){return X(T(T(T({},ve(e,t)),Se(e,t)),xe(e,t)))}const be=e=>{const{componentCls:t}=e;return{[t]:{display:"flex","&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},he=e=>{const{componentCls:t}=e;return{[t]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},we=e=>{const{componentCls:t}=e,n={};return J.forEach(a=>{n[`${t}-wrap-${a}`]={flexWrap:a}}),n},Ee=e=>{const{componentCls:t}=e,n={};return H.forEach(a=>{n[`${t}-align-${a}`]={alignItems:a}}),n},Fe=e=>{const{componentCls:t}=e,n={};return z.forEach(a=>{n[`${t}-justify-${a}`]={justifyContent:a}}),n},Oe=Y("Flex",e=>{const t=K(e,{flexGapSM:e.paddingXS,flexGap:e.padding,flexGapLG:e.paddingLG});return[be(t),he(t),we(t),Ee(t),Fe(t)]});function q(e){return["small","middle","large"].includes(e)}const je=()=>({prefixCls:$(),vertical:Z(),wrap:$(),justify:$(),align:$(),flex:M([Number,String]),gap:M([Number,String]),component:ee()});var Ae=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]]);return n};const $e=ne({name:"AFlex",inheritAttrs:!1,props:je(),setup(e,t){let{slots:n,attrs:a}=t;const{flex:s,direction:c}=ae(),{prefixCls:u}=oe("flex",e),[g,v]=Oe(u),p=k(()=>{var o;return[u.value,v.value,Ce(u.value,e),{[`${u.value}-rtl`]:c.value==="rtl",[`${u.value}-gap-${e.gap}`]:q(e.gap),[`${u.value}-vertical`]:(o=e.vertical)!==null&&o!==void 0?o:s==null?void 0:s.value.vertical}]});return()=>{var o;const{flex:r,gap:f,component:d="div"}=e,S=Ae(e,["flex","gap","component"]),m={};return r&&(m.flex=r),f&&!q(f)&&(m.gap=`${f}px`),g(se(d,re({class:[a.class,p.value],style:[a.style,m]},le(S,["justify","wrap","align","vertical"])),{default:()=>[(o=n.default)===null||o===void 0?void 0:o.call(n)]}))}}}),Me=te($e);function R(e){return ue()?(ce(e),!0):!1}function D(e){return typeof e=="function"?e():me(e)}const C=typeof window<"u"&&typeof document<"u",Re=typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope,Le=Object.prototype.toString,Ge=e=>Le.call(e)==="[object Object]",B=()=>{};function We(...e){if(e.length!==1)return ie(...e);const t=e[0];return typeof t=="function"?fe(pe(()=>({get:t,set:B}))):h(t)}function Te(e,t=1e3,n={}){const{immediate:a=!0,immediateCallback:s=!1}=n;let c=null;const u=h(!1);function g(){c&&(clearInterval(c),c=null)}function v(){u.value=!1,g()}function p(){const o=D(t);o<=0||(u.value=!0,s&&e(),g(),c=setInterval(e,o))}if(a&&C&&p(),de(t)||typeof t=="function"){const o=_(t,()=>{u.value&&C&&p()});R(o)}return R(v),{isActive:u,pause:v,resume:p}}function Ie(e){var t;const n=D(e);return(t=n==null?void 0:n.$el)!=null?t:n}const _e=C?window:void 0;function De(...e){let t,n,a,s;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,a,s]=e,t=_e):[t,n,a,s]=e,!t)return B;Array.isArray(n)||(n=[n]),Array.isArray(a)||(a=[a]);const c=[],u=()=>{c.forEach(o=>o()),c.length=0},g=(o,r,f,d)=>(o.addEventListener(r,f,d),()=>o.removeEventListener(r,f,d)),v=_(()=>[Ie(t),D(s)],([o,r])=>{if(u(),!o)return;const f=Ge(r)?{...r}:r;c.push(...n.flatMap(d=>a.map(S=>g(o,d,S,f))))},{immediate:!0,flush:"post"}),p=()=>{v(),u()};return R(p),p}const V="ping";function I(e){return e===!0?{}:e}function Ne(e,t={}){const{onConnected:n,onDisconnected:a,onError:s,onMessage:c,immediate:u=!0,autoClose:g=!0,protocols:v=[]}=t,p=h(null),o=h("CLOSED"),r=h(),f=We(e);let d,S,m=!1,F=0,O=[],j;const N=()=>{if(O.length&&r.value&&o.value==="OPEN"){for(const l of O)r.value.send(l);O=[]}},U=()=>{clearTimeout(j),j=void 0},b=(l=1e3,i)=>{!C||!r.value||(m=!0,U(),d==null||d(),r.value.close(l,i),r.value=void 0)},P=(l,i=!0)=>!r.value||o.value!=="OPEN"?(i&&O.push(l),!1):(N(),r.value.send(l),!0),G=()=>{if(m||typeof f.value>"u")return;const l=new WebSocket(f.value,v);r.value=l,o.value="CONNECTING",l.onopen=()=>{o.value="OPEN",F=0,n==null||n(l),S==null||S(),N()},l.onclose=i=>{if(o.value="CLOSED",a==null||a(l,i),!m&&t.autoReconnect&&l===r.value){const{retries:y=-1,delay:x=1e3,onFailed:A}=I(t.autoReconnect);typeof y=="number"&&(y<0||F<y)?(F+=1,setTimeout(G,x)):typeof y=="function"&&y()?setTimeout(G,x):A==null||A()}},l.onerror=i=>{s==null||s(l,i)},l.onmessage=i=>{if(t.heartbeat){U();const{message:y=V,responseMessage:x=y}=I(t.heartbeat);if(i.data===x)return}p.value=i.data,c==null||c(l,i)}};if(t.heartbeat){const{message:l=V,interval:i=1e3,pongTimeout:y=1e3}=I(t.heartbeat),{pause:x,resume:A}=Te(()=>{P(l,!1),j==null&&(j=setTimeout(()=>{b(),m=!1},y))},i,{immediate:!1});d=x,S=A}g&&(C&&De("beforeunload",()=>b()),R(b));const W=()=>{!C&&!Re||(b(),m=!1,F=0,G())};return u&&W(),_(f,W),{data:p,status:o,close:b,send:P,open:W,ws:r}}function qe(e=!0){const t=w(["control"]);return ye({queryKey:["control"],refetchInterval:1e3,enabled:e,queryFn:async()=>{const{data:n}=await E.get(t("status"));return n}})}function Ve(){const e=w(["control"]),t=Q();return L({mutationFn:async()=>{await E.post(e("start"))},onSuccess:()=>{t.invalidateQueries({queryKey:["control"]})}})}function ke(){const e=w(["control"]),t=Q();return L({mutationFn:async()=>{await E.post(e("stop"))},onSuccess:()=>{t.invalidateQueries({queryKey:["control"]})}})}function Qe(){const e=w(["control"]);return L({mutationFn:async t=>{const n=new FormData;n.append("file",t),await E.post(e("model"),n)}})}function Je(){const e=w(["control"]);return L({mutationFn:async t=>{const n=new FormData;n.append("file",t),await E.post(e("map"),n)}})}function ze(e,t,n,a){const s=ge(["control"]),c=k(()=>s("ws"));return Ne(c,{autoReconnect:{delay:3e3},onMessage:e,onError:t,onConnected:n,onDisconnected:a})}export{Me as F,Ve as a,ke as b,Je as c,Qe as d,ze as e,qe as u};
